<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Undangan</title>

    <link rel="stylesheet" href="css/style.css" />

    <style>
      .grid {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
      }
      .box {
        flex: 1;
        min-width: 280px;
      }
      textarea {
        width: 100%;
      }
      .hasil {
        background: #f4f4f4;
        padding: 10px;
        margin-top: 10px;
        word-break: break-all;
      }
    </style>
  </head>

  <body>
    <section class="content">
      <h2>Admin Undangan</h2>
      <p>Masukkan nama tamu (1 baris = 1 nama)</p>

      <div class="grid">
        <!-- PIHAK COWO -->
        <div class="box">
          <h3>Pihak Cowo</h3>
          <textarea
            id="nama-tamu-welcome"
            rows="10"
            placeholder="Andi Saputra"
          ></textarea>

          <h4>Link Undangan Cowo</h4>
          <div id="hasil-link-cowo" class="hasil"></div>
        </div>

        <!-- PIHAK CEWE -->
        <div class="box">
          <h3>Pihak Cewe</h3>
          <textarea
            id="nama-tamu-cewe"
            rows="10"
            placeholder="Siti Aminah"
          ></textarea>

          <h4>Link Undangan Cewe</h4>
          <div id="hasil-link-cewe" class="hasil"></div>
        </div>
      </div>

      <br />
      <button id="generate-btn">Generate Link</button>
    </section>

    <script>
      const templatePesan = (nama, link) => `
Assalamualaikum Warahmatullahi Wabarakatuh

Tanpa mengurangi rasa hormat, perkenankan kami mengundang Bapak/Ibu/Saudara/i ${nama}, teman sekaligus sahabat, untuk menghadiri acara pernikahan kami.

Berikut link undangan kami, untuk info lengkap dari acara, bisa kunjungi :

${link}

Merupakan suatu kebahagiaan bagi kami apabila Bapak/Ibu/Saudara/i berkenan untuk hadir dan memberikan doa restu.

Wassalamualaikum Warahmatullahi Wabarakatuh

Terima Kasih

Hormat kami,
Ahmad & Devina

________

Simpan nomor ini jika link tidak dapat disentuh atau salin link ke browser untuk membuka undangan
Harap dibuka pada aplikasi Chrome
`;

      function copyText(id) {
        const el = document.getElementById(id);
        el.select();
        el.setSelectionRange(0, 99999);
        document.execCommand("copy");
        alert("Pesan berhasil disalin!");
      }

      function generatePesan(type) {
        const textareaId =
          type === "cowo" ? "nama-tamu-welcome" : "nama-tamu-cewe";
        const hasilId = type === "cowo" ? "hasil-link-cowo" : "hasil-link-cewe";

        const daftarNama = document
          .getElementById(textareaId)
          .value.split("\n");

        const baseURL =
          window.location.origin +
          window.location.pathname.replace("admin.html", "index.html");

        let html = `
      <table border="1" cellpadding="8" cellspacing="0" width="100%">
        <tr>
          <th>Nama</th>
          <th>Pesan WhatsApp</th>
          <th>Aksi</th>
        </tr>
    `;

        daftarNama.forEach((nama, index) => {
          const clean = nama.trim();
          if (clean !== "") {
            const namaUpper = clean.toUpperCase();
            const encoded = encodeURIComponent(namaUpper);
            const link = `${baseURL}?to=${encoded}&from=${type}&v=${index + 1}`;

            const pesan = templatePesan(namaUpper, link);
            const textareaIdUnik = `pesan-${type}-${index}`;

            html += `
          <tr>
            <td><strong>${namaUpper}</strong></td>
            <td>
              <textarea
                id="${textareaIdUnik}"
                rows="12"
                style="width:100%"
                readonly
              >${pesan}</textarea>
            </td>
            <td>
              <button onclick="copyText('${textareaIdUnik}')">
                Copy
              </button>
            </td>
          </tr>
        `;
          }
        });

        html += "</table>";
        document.getElementById(hasilId).innerHTML = html;
      }

      // ganti tombol lama â†’ dua tombol terpisah
      document.getElementById("generate-btn").remove();

      const btnCowo = document.createElement("button");
      btnCowo.innerText = "Generate Tamu Cowo";
      btnCowo.onclick = () => generatePesan("cowo");

      const btnCewe = document.createElement("button");
      btnCewe.innerText = "Generate Tamu Cewe";
      btnCewe.onclick = () => generatePesan("cewe");

      const content = document.querySelector(".content");
      content.appendChild(btnCowo);
      content.appendChild(btnCewe);
    </script>
  </body>
</html>
